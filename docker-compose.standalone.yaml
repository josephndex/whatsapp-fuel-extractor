# WhatsApp Fuel Extractor - Standalone (connects to external Evolution API)
# Use this if Evolution API is deployed separately

version: '3.8'

services:
  fuel-extractor:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: fuel-extractor
    restart: unless-stopped
    ports:
      - "8000:8000"
    environment:
      # Database (External MySQL via Tailscale)
      - DB_HOST=100.83.80.26
      - DB_NAME=logistics_department
      - DB_USER=RITA
      - DB_PASSWORD=RITANDEX101/
      - DB_PORT=3306
      - DB_DRIVER=mysql+pymysql
      # Google Sheets
      - GOOGLE_SHEETS_SPREADSHEET_ID=1gAq2TUBWPIKUAXRcHYeeq85ltktWgXUoe9QDDkRYSQo
      # Evolution API (external - update URL after deploying Evolution)
      - EVOLUTION_API_URL=http://localhost:8080
      - EVOLUTION_API_KEY=B6D711FCDE4D4FD5936544120E713976
      - EVOLUTION_INSTANCE_NAME=fuel-extractor
      # Web Server
      - WEB_HOST=0.0.0.0
      - WEB_PORT=8000
    volumes:
      # Only mount data directory for persistence
      - fuel_data:/app/data
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8000/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s

volumes:
  fuel_data:
